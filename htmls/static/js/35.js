webpackJsonp([35],{"443u":function(e,t,a){var n=a("L4zZ");(e.exports=a("UTlt")(!1)).push([e.i,"\n.sina_page[data-v-1af4bd89]{background:#fff;position:relative;padding-bottom:9.375rem\n}\n.sina_page .join_intro[data-v-1af4bd89]{border-bottom:0.625rem solid #f9f9f9\n}\n.sina_page .join_intro .sina_hasbg[data-v-1af4bd89]{background-repeat:no-repeat;background-size:100% auto;background-color:#fff;position:relative\n}\n.sina_page .join_intro .sina_hasbg .sina_join_cont[data-v-1af4bd89]{padding:10.15625rem 0 0\n}\n.sina_page .join_intro .sina_hasbg .sina_join_cont .sina_radius_bg[data-v-1af4bd89]{margin:0;min-height:11.4375rem;padding:1.6875rem 1.25rem 1.75rem;-webkit-box-shadow:none;box-shadow:none;border-radius:1.875rem 1.875rem 0 0;position:relative\n}\n.sina_page .add_form[data-v-1af4bd89]{padding:0.625rem 0  0.625rem 0.9375rem\n}\n.sina_page .add_form .sina_input_normal .input_css[data-v-1af4bd89]{padding-right:0.9375rem\n}\n.sina_page .myAd[data-v-1af4bd89]{padding:0.875rem 0.5625rem 0\n}\n.sina_page .sina_page_bot[data-v-1af4bd89]{width:100%;position:fixed;left:0;bottom:0;background:#fff\n}\n.sina_page .sina_page_bot .join_desc[data-v-1af4bd89]{margin-top:0.375rem;padding-left:2.96875rem;padding-right:1.5625rem\n}\n.sina_page .sina_page_bot .join_desc .checkbox[data-v-1af4bd89]{left:1.6875rem\n}\n.sina_page .sina_page_bot .bot_btns[data-v-1af4bd89]{width:100%;margin-top:0.9375rem;border-top:0.03125rem solid #e6e6e6;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between\n}\n.sina_page .sina_page_bot .bot_btns .bot_btn[data-v-1af4bd89]{width:8.75rem;height:3.0625rem;line-height:3.0625rem;font-size:1rem;text-align:center;color:#939393;background:#fff\n}\n.sina_page .sina_page_bot .bot_btns .bot_btn.primary[data-v-1af4bd89]{background:#ff8200;color:#fff\n}\n.sina_page .hasarrow[data-v-1af4bd89]{padding-right:2.4375rem\n}\n.sina_page .hasarrow.right[data-v-1af4bd89]::after{right:1.125rem\n}\n.sina_page .hasarrow .type_name[data-v-1af4bd89]{text-align:right;color:#333\n}\n.toast-mask .img_bg[data-v-1af4bd89]{width:17.8125rem;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)\n}\n.toast-mask .auth_btn[data-v-1af4bd89]{width:14rem;height:3.125rem;line-height:3.125rem;border-radius:1.59375rem;font-size:1.25rem;border:0;position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);bottom:3.6875rem\n}\n.toast-mask .noauth_btn[data-v-1af4bd89]{width:100%;height:3.125rem;line-height:3.125rem;position:absolute;left:0;bottom:0;background:transparent;color:#939393;font-size:0.875rem;border:0\n}\n.toast-mask .closebtn[data-v-1af4bd89]{width:2rem;height:2rem;position:absolute;top:-2.75rem;right:0;background-image:url("+n(a("xFVY"))+");background-repeat:no-repeat;background-size:cover;background-position:center 0\n}\n",""])},GZIn:function(e,t,a){e.exports=a.p+"static/img/fyJoin2banner.54a0afc.png"},"a+y6":function(e,t,a){e.exports=a.p+"static/img/sinaJoinAlertImg_2x.3ad6750.png"},d30c:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("2Uyi"),i=a("Zq1L"),o=a("KzFb"),s=a("qWUe"),r=a("Ntn1"),l={name:"join",props:{planCode:{type:String,default:"XL001"}},components:{clauseAlert:o.a,propHelptype:s.a,myAd:r.a},data:function(){return{userInfo:{userName:"",idNo:"",mobile:"",helpType:"1"},alertShow:!1,alertIndex:0,alertChecked:!0,isChecked:!0,workTypeShow:!1,workTypeIndex:0,workTypeList:[{name:"普通会员",desc:""},{name:"医护会员",desc:""}],adImg:null,authAlertShow:!1,channelType:null}},created:function(){this.getPlanStatus()},methods:{getPlanStatus:function(){var e=this;this.$get(i.a.getMyPolicy,{}).then(function(t){0===t.code&&(t.data.plan_list_state&&"not_join"!=t.data.plan_list_state[e.planCode]?e.$router.replace("/weibo/insure-plan"):e.loadPage())})},loadPage:function(){if(this.checkChannel(),1==this.$route.query.hasChecked&&this.$post(i.a.subscribe),sessionStorage.getItem("myPlanInfo")){var e=JSON.parse(sessionStorage.getItem("myPlanInfo")).dataList[0].insured;this.userInfo={userName:e.name,idNo:e.idno_init,mobile:e.mobile,helpType:"1"},this.authAlertShow=!1}else this.getPlanList();this.actionCount("pv")},checkChannel:function(){var e=this,t=this.$route.query.channel||localStorage.getItem("channel")||1e4;"XL001"==this.planCode&&this.$get(i.a.checkRedPacketChannel,{channel:t}).then(function(a){if(0==a.code){var n=a.data.type_list;n.length>0&&n.join(",").indexOf("give_score")>-1?e.channelType="giveChannel":(e.channelType="otherChannel",e.$post(i.a.joinTicket,{sign:"898c4f832a7337c11dfcd8223afcf07c"})),"30012"==t&&(e.channelType="defChannel");var o=a.data.ad_list;o&&o.length>0&&o.forEach(function(t){"weibo-insure-write-11"==t.pos&&(e.adImg=t)})}else e.channelType="giveChannel"})},getPlanList:function(){var e=this;this.$get(i.a.getPolicyList,{}).then(function(t){if(0==t.code)if(t.data.policy_list.length>0){var a=t.data.policy_list[0].insured;e.userInfo={userName:a.name,idNo:a.idno_init,mobile:a.mobile,helpType:"1"}}else e.checkSinaAuth();else e.$toast(t.msg||"请求超时，请刷新重试")})},checkSinaAuth:function(){this.$route.query.msg||this.$route.query.button?(this.noAuthEvent(),this.getSinaUserInfo()):(sessionStorage.getItem("_authAlert"),this.authAlertShow=!1)},showAlert:function(e){this.alertIndex=e,this.alertShow=!0},cancelJoin:function(){"XL001"==this.planCode?this.$router.push("/weibo/insure-join"):this.$router.push("/weibo/feiyan-intro")},addJoin:function(){var e=this;if(!this.userInfo.userName)return this.$toast("请填写真实姓名"),!1;if(!Object(n.b)(this.userInfo.userName.replace(/\s/g,"")))return this.$toast("只支持中文姓名"),!1;if(this.userInfo.userName.length<2)return this.$toast("姓名不得少于两个字符"),!1;if(!this.userInfo.mobile)return this.$toast("请输入手机号"),!1;if(!Object(n.a)(this.userInfo.mobile.replace(/\s/g,"")))return this.$toast("手机号格式不正确"),!1;if(!this.userInfo.idNo)return this.$toast("请输入身份证号码"),!1;if(!Object(n.c)(this.userInfo.idNo.replace(/\s/g,"")))return this.$toast("请输入正确的身份证号码"),!1;if(!this.alertChecked)return this.$toast("请勾选我已阅读并同意"),!1;this.userInfo.helpType=1*this.helpTypeIndex+1,this.actionCount("click");localStorage.getItem("channel");"XL003"==this.planCode&&localStorage.getItem("channel");var t={user_name:this.userInfo.userName.replace(/\s/g,""),certi_no:this.userInfo.idNo.replace(/\s/g,""),mobile:this.userInfo.mobile.replace(/\s/g,""),help_type:1,certi_type:"00",relation:"00",plan_code:this.planCode,work_type:1*this.workTypeIndex+1,channel:localStorage.getItem("channel")||"810000",amount:0};"XL001"==this.planCode&&delete t.work_type,this.$post(i.a.addPolicy,t).then(function(t){0===t.code?(e.isChecked?localStorage.setItem("_sendNotice","join"):localStorage.removeItem("_sendNotice"),sessionStorage.removeItem("myPlanInfo"),sessionStorage.removeItem("_authAlert"),sessionStorage.removeItem("_redpackAdShow"),0==t.data.state?e.bindWallet():"XL001"==e.planCode?e.$router.push("/weibo/insure-paysuc"):e.$router.push("/weibo/feiyan-paysuc")):e.$toast(t.msg||"请求失败，请刷新重试")})},bindWallet:function(){var e=this;this.$post(i.a.bindWallet,{plan_code:this.planCode}).then(function(t){0==t.code?t.data.state&&"not_bind"==t.data.state?(window.location.href=t.data.url,"XL001"==e.planCode&&setTimeout(function(){e.$router.push("/weibo/note-redpacket")},500)):"XL001"==e.planCode?e.$router.push("/weibo/insure-paysuc"):e.$router.push("/weibo/feiyan-paysuc"):e.$toast(t.msg||"请求失败，请刷新重试")})},confirmProp:function(e){this.workTypeIndex=e,this.workTypeShow=!1},authEvent:function(){this.actionCount("sinaAd_click");var e=window.location,t=e.hostname,a=e.origin,n="localhost"==t?"http://sinatest.bihubao.com/weibo/insure-write":a+this.$route.path;this.$get("https://saas.bihubao.com/contract/misc/getWeiboAuth",{redirect_url:n},!0).then(function(e){window.location.href=e.url})},noAuthEvent:function(){this.authAlertShow=!1,sessionStorage.setItem("_authAlert","hidden")},getSinaUserInfo:function(){var e=this,t=sessionStorage.getItem("weiboInfo")?JSON.parse(sessionStorage.getItem("weiboInfo")).uid:"";this.$jsonp("https://finance.sc.weibo.com/api/authority/request?Appkey=3040890735&uid="+t).then(function(a){if(1e5==a.code){var n=new FormData;n.append("Appkey","3040890735"),n.append("uid",t),n.append("verify",a.data.verify),e.$post("https://saas.bihubao.com/contract/misc/weiboAuthInfo",n,!0,!0).then(function(t){if(1e5==t.code){var a=t.data.userinfo;1e5==a.name.code&&(e.userInfo.userName=t.data.userinfo.name.msg||""),1e5==a.idnum.code&&(e.userInfo.idNo=t.data.userinfo.idnum.msg||"",e.actionCount("sinaAuth_idNo")),1e5==a.mobile.code&&(e.userInfo.mobile=t.data.userinfo.mobile.msg||"")}})}})}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sina_page"},["XL001"==e.planCode?n("div",{staticClass:"join_intro"},[n("transition",{attrs:{name:"fade"}},[e.adImg?n("img",{attrs:{src:e.adImg.img_url}}):e._e()]),e._v(" "),n("div",{staticClass:"sina_hasbg",class:{join_bg:"giveChannel"==e.channelType,channel_nogive:"otherChannel"==e.channelType,channel_default:"defChannel"==e.channelType}},[n("div",{staticClass:"sina_join_cont"},[n("div",{staticClass:"sina_radius_bg"},["giveChannel"==e.channelType?n("img",{attrs:{src:"http://bihu-oss.oss-cn-beijing.aliyuncs.com/images/sina_weibo/DBWriteFormIntro_2x.png?v=1.0"}}):e._e(),e._v(" "),"otherChannel"==e.channelType?n("img",{attrs:{src:"http://bihu-oss.oss-cn-beijing.aliyuncs.com/images/sina_weibo/DBWriteFormIntro1_2x.png?v=1.0"}}):e._e(),e._v(" "),"defChannel"==e.channelType?n("img",{attrs:{src:"http://bihu-oss.oss-cn-beijing.aliyuncs.com/images/sina_weibo/DBWriteFormIntro2_2x.png?v=1.0"}}):e._e()])])])],1):e._e(),e._v(" "),"XL003"==e.planCode?n("img",{attrs:{src:a("GZIn")}}):e._e(),e._v(" "),n("div",{staticClass:"add_form"},[n("div",{staticClass:"input_cells"},[n("div",{staticClass:"sina_input_normal"},[n("span",{staticClass:"label"},[e._v("真实姓名")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.userInfo.userName,expression:"userInfo.userName",modifiers:{trim:!0}}],staticClass:"input_css",attrs:{autocomplete:"off",maxlength:"10",type:"text",placeholder:"请输入真实姓名",value:""},domProps:{value:e.userInfo.userName},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"userName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"sina_input_normal"},[n("span",{staticClass:"label"},[e._v("身份证号")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.userInfo.idNo,expression:"userInfo.idNo",modifiers:{trim:!0}}],staticClass:"input_css",attrs:{type:"text",autocomplete:"off",maxlength:"18",placeholder:"请输入身份证号",value:""},domProps:{value:e.userInfo.idNo},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"idNo",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"sina_input_normal"},[n("span",{staticClass:"label"},[e._v("手机号")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.userInfo.mobile,expression:"userInfo.mobile",modifiers:{trim:!0}}],staticClass:"input_css",attrs:{type:"tel",autocomplete:"off",maxlength:"11",placeholder:"请输入手机号"},domProps:{value:e.userInfo.mobile},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"mobile",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),e._v(" "),"XL003"==e.planCode?n("div",{staticClass:"sina_input_normal hasarrow right",on:{click:function(t){e.workTypeShow=!0}}},[n("span",{staticClass:"label"},[e._v("职业")]),e._v(" "),n("span",{staticClass:"flex1 type_name"},[e._v(e._s(e.workTypeList[e.workTypeIndex].name))])]):e._e()])]),e._v(" "),n("div",{staticClass:"sina_page_bot"},["XL001"==e.planCode?n("div",{staticClass:"join_desc",on:{click:function(t){e.isChecked=!e.isChecked}}},[n("i",{staticClass:"checkbox",class:{checked:e.alertChecked}}),e._v(" 加入成功后发送微博邀请更多好友共享互助\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"join_desc"},[n("i",{staticClass:"checkbox",class:{checked:e.alertChecked},on:{click:function(t){t.stopPropagation(),e.alertChecked=!e.alertChecked}}}),e._v("\n      我已阅读并同意\n      "),n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(1)}}},[e._v("《会员公约》")]),e._v(" "),"XL003"==e.planCode?n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(6)}}},[e._v("《计划章程》")]):e._e(),e._v(" "),n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(3)}}},[e._v("《授权代扣委托书》")]),e._v(" "),n("br"),e._v(" "),"XL001"==e.planCode?n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(0)}}},[e._v("《健康告知》")]):e._e(),e._v(" "),"XL001"==e.planCode?n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(2)}}},[e._v("《计划章程》")]):e._e(),e._v(" "),"XL001"==e.planCode?n("a",{staticClass:"col_a",attrs:{href:"javascript:;"},on:{click:function(t){return e.showAlert(7)}}},[e._v("《会员隐私政策》")]):e._e()]),e._v(" "),n("div",{staticClass:"bot_btns"},[n("div",{staticClass:"bot_btn ",on:{click:function(t){return e.cancelJoin()}}},[e._v("取消")]),e._v(" "),n("div",{staticClass:"bot_btn primary flex1",on:{click:function(t){return e.addJoin()}}},[e._v("0元加入")])])]),e._v(" "),e.alertShow?n("clause-alert",{attrs:{alertShow:e.alertShow,alertIndex:e.alertIndex},on:{closeClauseAlert:function(t){e.alertShow=!1}}}):e._e(),e._v(" "),n("prop-helptype",{attrs:{title:"职业",show:e.workTypeShow,checkedIndex:e.workTypeIndex,dataList:e.workTypeList},on:{closeProp:function(t){e.workTypeShow=!1},confirmProp:e.confirmProp}}),e._v(" "),"XL001"==e.planCode&&e.authAlertShow?n("div",{staticClass:"toast-mask"},[n("div",{staticClass:"img_bg"},[n("img",{attrs:{src:a("a+y6")}}),e._v(" "),n("div",{staticClass:"closebtn",on:{click:e.noAuthEvent}}),e._v(" "),n("button",{staticClass:"sina_btn primary radius auth_btn",on:{click:function(t){return e.authEvent()}}},[e._v("一键加入")]),e._v(" "),n("button",{staticClass:"noauth_btn",on:{click:function(t){return e.noAuthEvent()}}},[e._v("手动填写")])])]):e._e()],1)},staticRenderFns:[]};var d={name:"join",components:{insureJoin:a("C7Lr")(l,c,!1,function(e){a("dOWW")},"data-v-1af4bd89",null).exports}},u={render:function(){var e=this.$createElement;return(this._self._c||e)("insureJoin",{attrs:{planCode:"XL003"}})},staticRenderFns:[]},h=a("C7Lr")(d,u,!1,null,null,null);t.default=h.exports},dOWW:function(e,t,a){var n=a("443u");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("FIqI")("7e148d70",n,!0,{})}});